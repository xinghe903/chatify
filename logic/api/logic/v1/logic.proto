syntax = "proto3";

package logic.v1;

import "im/v1/message.proto";

option go_package = "api/logic/v1;v1";

service LogicService {
  // 接收原始消息，返回是否允许发送
  rpc ValidateAndProcessMessage(ChatInputRequest) returns (ChatInputResponse);
  
  // 系统主动推送（公告、通知）
  rpc SendSystemPush(SystemPushRequest) returns (SystemPushResponse);
}

message ChatInputRequest {
  im.v1.BaseMessage message = 1;   // 只会取targets[0]第一个用户
}

message ChatInputResponse {
  enum Code {
    OK = 0;
    NOT = 1;
  }
  Code code = 1;
  string message = 2;
}

message SystemPushRequest {
  im.v1.BaseMessage message = 1;
}

message SystemPushResponse {
  bool success = 1;
}